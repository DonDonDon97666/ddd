# DDD

在微服务架构流行时期，开始流行。指导微服务架构。

在战略方面，可以指导微服务拆分。
在战术方面，可以指导代码编写。

## 指导应用架构：战术篇

ddd中的领域服务、实体、值对象、充血模型不是凭空产生的，而是为了应对软件变化，一步步抽取出来的。

充血模型隔离的变化是：业务逻辑分散在 mvc Service 层中。

领域服务隔离的变化是：领域对象互相之间的操作和技术变化。

ddd也不是强制要求软件所有地方都是用充血模型，因为贫血和充血各有各的好处。

贫血模型更像一个简单粗暴的草根，适合团队技术水平参差不齐，软件维护成本较低的团队。

充血模型虽然将数据与行为隔离到了领域对象中，但它更像一个昂贵的贵族，因为缺少强制性约束，更多是需要团队内部从上到下约束，随着软件演进，很容易四不像，需要额外付出成本维护。

因此，实际开发中，在设计方面，可以灵活均衡贫血和充血，一般来讲，可以将核心业务领域使用充血模型维护，其他边缘业务领域使用贫血维护。

最后，通过防腐层保持底层领域模型的稳定，比如 repository 隔离 kafka、数据库变化。

聚合、聚合根隔离的是数据一致性变化。

聚合的关注点是“区域自治”，即在一个具体的业务场景设计中，将一个大的问题拆分成多个相对独立的聚合。

仓库、工厂隔离的是底层存储变化。

## 指导微服务拆分：战略篇

领域

限界上下文

![img.png](img.png)

## 指导企业中台建设

异曲同工
![img_1.png](img_1.png)

## ddd分层方法

强调层与层之间互相依赖，不能跨层依赖。

1. 洋葱架构
2. 六边形架构
3. 清晰架构

三种架构考虑的核心问题都是：前端需求的变 和 领域模型的不变

基于上述三种架构，抽象出通用架构：菱形对称架构
![img_2.png](img_2.png)

ddd本质是解耦，方法很多，架构思路是一致的。本质的思路是对领域模型进行有效的保护，以减少业务变化对领域模型的影响。